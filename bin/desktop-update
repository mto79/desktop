#!/usr/bin/env bash

set -e

# Sudo keep-alive
if ! sudo -n true 2>/dev/null; then
  sudo -v
fi
while true; do
  sudo -n true
  sleep 60
  kill -0 "$$" || exit
done 2>/dev/null &

desktop-update-git
desktop-migrate
desktop-update-cargo
desktop-update-flatpak
desktop-update-system-pkgs
desktop-update-fw
desktop-update-restart

# Ensure Waybar available update function is refreshed
pkill -RTMIN+7 waybar
